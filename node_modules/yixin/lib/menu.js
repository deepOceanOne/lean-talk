/**
 * Created by fuzesun on 14-5-14.
 */
/**
 * 用于生成菜单的工具类
 * Example:
 * ```
 * var menu = new Menu();
 * menu
 *   .addButton(
 *   {
 *     "name" : "在线客服",
 *     "sub_button" : [ { "key" : "/dt2/ai.yx",
 *       "name" : "召唤精灵",
 *       "type" : "click"
 *     },
 *     { "key" : "/dt2/chat.yx",
 *       "name" : "人工服务",
 *       "type" : "click"
 *     }]
 *   })
 *   .addButton(
 *   {
 *     "name" : "自助服务"
 *   })
 *   .addSubButton(
 *   {
 *     "name" : "自主服务１",
 *     "type" : "click",
 *     "key" :  "/dt2/self.yx1"
 *   })
 *   .addSubButton(
 *   {
 *     "name" : "自主服务２",
 *     "type" : "click",
 *     "key" : "/dt2/self.yx2"
 *   });
 *   menu.JSON();
 * ```
 * Return:
 * { "button" : [ { "name" : "在线客服",
 *     "sub_button" : [ { "key" : "/dt2/ai.yx",
 *           "name" : "召唤精灵",
 *           "type" : "click"
 *         },
 *         { "key" : "/dt2/chat.yx",
 *           "name" : "人工服务",
 *           "type" : "click"
 *         }
 *       ]
 *   },
 *   {
 *     "name" : "自助服务",
 *     "sub_button" : [
 *     {
 *       "name" : "自主服务１",
 *       "type" : "click",
 *       "key" :  "/dt2/self.yx1"
 *     },{
 *       "name" : "自主服务２",
 *       "type" : "click",
 *       "key" : "/dt2/self.yx2"
 *     }]
 *   }
 * }
 * ```
 * @constructor
 */
var Menu = function() {
  this.buttons = [];
};

var menu = Menu.prototype;
/**
 * 添加菜单
 *
 * @param opts
 * @returns {Menu}
 */
menu.addButton = function(opts) {
  var button = {};
  var options = opts || {};
  if(!!options.name) {
    button.name = options.name;
  }
  if(!!options.key) {
    button.key = options.key;
  }
  if(!!options.type) {
    button.type = options.type;
  }
  if(!!options.sub_button) {
    button.sub_button = options.sub_button;
  }
  this.buttons.push(button);
  return this;
};

menu.addSubButton = function(ops) {
  var options = ops || {};
  var subButton = {};
  var len = this.buttons.length;
  if(len < 1) {
    return this;
  }
  var curButton = this.buttons[len - 1];
  var subButtons = curButton.sub_button || [];
  if(!!options.key) {
    subButton.key = options.key;
  }
  if(!!options.name) {
    subButton.name = options.name;
  }
  if(!!options.type) {
    subButton.type = options.type;
  }
  subButtons.push(subButton);

  curButton.sub_button = subButtons;
  return this;
};

menu.JSON = function() {
  return {"button": this.buttons};
};

module.exports = Menu;